<!--
*** Thanks for checking out this README Template. If you have a suggestion that would
*** make this better, please fork the repo and create a pull request or simply open
*** an issue with the tag "enhancement".
*** Thanks again! Now go create something AMAZING! :D
-->




<!-- PROJECT LOGO -->
<br />
<p align="center">

  <h3 align="center">Resetting Expectations for Herd Immunity and Continued SARS-CoV-2 Transmission</h3> 

  <p align="center">
    Supporting code for the paper
  </p>
</p>



<!-- TABLE OF CONTENTS -->
## Table of Contents

* [About the Code](#about-the-code)
* [Running the Code](#running-the-code)
  * [Data files](#data-files)
  * [Data analysis code](#data-analysis-code)
  * [Network model of transmission code](#network-model-of-transmission-code)
  * [Usage](#usage)
* [Contact](#contact)



<!-- ABOUT THE PROJECT -->
## About the Code

The code in this repository allows for repeat and independent analysis of the one described in the paper "Resetting Expectations for Herd Immunity and Continued SARS-CoV-2 Transmission", by Felix Wong and James J. Collins. The code requires MATLAB 2019b or later to run. 

<!-- GETTING STARTED -->
## Running the Code


### Network model of transmission code

In the main folder, there are MATLAB scripts for reproducing the network models of transmissions detailed in the main text.

* no_exogenous_infections.m
<p>
This file is the main simulation script. It generates BA or WS random graphs and runs the SEIR simulation described in the main text. It does not take into account any exogenous infections. (For a complete graph, generate the adjacency matrix using the <b>ones()</b> function.)
</p>

* exogenous_infection.m
<p>
This file is an adaptation of the main simulation script, taking into account any exogenous infections. It assumes that the graph model is already generated and the adjacency matrix is stored in the variable, <i>A</i>. Run this after having run no_exogenous_infections.m to ensure that the graph model is properly stored. To consider the cases of random vaccination presented, uncomment the corresponding lines of code indicated. 

* SEIR.m
<p>
This file simulates a well-mixed SEIR model and plots the resultant total infected curve. There are portions of the code which can account for exogenous infections when uncommented. 
</p>

* WattsStrogatz.m
<p>
Auxiliary script for generating a WS random graph with specified parameters.
</p>

<p>
<b>Please note:</b> Extended Data Table 1 of the paper contains more details regarding simulation parameters.
</p>


### Usage

To run the main analysis, simply run in MATLAB:
```sh
no_exogenous_infections.m
```
This will build the graph model as specified, then run the SEIR simulations described. By default, the code is initialized to a BA model with 100 nodes, but one can easily specify the option for changing the number of nodes or the random graph model (BA or WS). After the code above is executed, the graph model's adjacency matrix should be stored in a variable, <i>A</i>. This is needed to run the simulations with exogenous infections, which can be executed simply with:  
```sh
exogenous_infection
```
The key output variables are annotated directly in the script. Of note, NUM_INF is the variable that stores the cumulative infected fraction in the model, across all replicate simulations, for a fixed value of the exogeous infection intensity parameter <i>f</i>. Finally, the predictions of a well-mixed SEIR model can be generated by executing directly the following:
```sh
SEIR
```
The script can be changed in the commented regions to model the effects of exogenous infections. 

<!-- CONTACT -->
## Contact

For questions or comments about this code, please reach out to felix j wong at gmail (no spaces, add domain name). 

